<?xml version="1.0" encoding="UTF-8"?>
<PolicySet
    xmlns="urn:oasis:names:tc:xacml:2.0:policy:schema:os"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
    xsi:schemaLocation="urn:oasis:names:tc:xacml:2.0:policy:schema:os 
      http://docs.oasis-open.org/xacml/access_control-xacml-2.0-policy-schema-os.xsd" 
    PolicySetId="urn:va:xacml:2.0:interop:rsa8:policysetid:toplevel"
    PolicyCombiningAlgId=
      "urn:oasis:names:tc:xacml:1.0:policy-combining-algorithm:deny-overrides">
  <Description>
      Top level policy set which combines the CDA and N confidentiality codes.
  </Description>
  <Target/>
  <PolicySet
      PolicySetId="urn:va:xacml:2.0:interop:rsa8:policysetid:toplevel:emergency"
      PolicyCombiningAlgId=
        "urn:oasis:names:tc:xacml:1.0:policy-combining-algorithm:deny-overrides">
    <Target/>
    <PolicySetIdReference
      >urn:va:xacml:2.0:interop:rsa8:policysetid:emergency</PolicySetIdReference>
  </PolicySet>
  <PolicySet
      PolicySetId="urn:va:xacml:2.0:interop:rsa8:policysetid:toplevel:CDA"
      PolicyCombiningAlgId=
        "urn:oasis:names:tc:xacml:1.0:policy-combining-algorithm:deny-overrides">
    <Target>
      <Resources>
        <Resource>
          <ResourceMatch
              MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
            <AttributeValue
                DataType="http://www.w3.org/2001/XMLSchema#string"
              >UBA</AttributeValue>
            <ResourceAttributeDesignator
                AttributeId=
                  "urn:va:xacml:2.0:interop:rsa8:resource:hl7:confidentiality-code"
                DataType="http://www.w3.org/2001/XMLSchema#string"/>
          </ResourceMatch>
        </Resource>
      </Resources>
    </Target>
    <PolicySetIdReference
      >urn:va:xacml:2.0:interop:rsa8:policysetid:CDA</PolicySetIdReference>
  </PolicySet>
  <PolicySet
      PolicySetId="urn:va:xacml:2.0:interop:rsa8:policysetid:toplevel:MA"
      PolicyCombiningAlgId=
        "urn:oasis:names:tc:xacml:1.0:policy-combining-algorithm:permit-overrides">
    <Target>
      <Resources>
        <Resource>
          <ResourceMatch
              MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
            <AttributeValue
                DataType="http://www.w3.org/2001/XMLSchema#string"
              >MA</AttributeValue>
            <ResourceAttributeDesignator
                AttributeId=
                 "urn:va:xacml:2.0:interop:rsa8:resource:hl7:confidentiality-code"
                DataType="http://www.w3.org/2001/XMLSchema#string"/>
          </ResourceMatch>
        </Resource>
      </Resources>
    </Target>
	 <PolicySetIdReference
      >urn:va:xacml:2.0:interop:rsa8:policysetid:MA</PolicySetIdReference>
    <Policy 
        PolicyId="urn:va:xacml:2.0:interop:rsa8:policyid:MA:default-to-permit"
        RuleCombiningAlgId=
          "urn:oasis:names:tc:xacml:1.0:rule-combining-algorithm:permit-overrides">
      <Target/>
      <Rule
          RuleId="urn:va:xacml:2.0:interop:rsa8:rule:MA"
          Effect="Permit">
        <Description>
          If a Deny was obtained for object above then set Permit by default.
	     </Description>
      </Rule>
    </Policy>
  </PolicySet>
  <PolicySet
      PolicySetId="urn:va:xacml:2.0:interop:rsa8:policysetid:toplevel:bus-rule"
      PolicyCombiningAlgId=
        "urn:oasis:names:tc:xacml:1.0:policy-combining-algorithm:deny-overrides">
    <Target>
      <Resources>
        <Resource>
          <ResourceMatch
              MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
            <AttributeValue
                DataType="http://www.w3.org/2001/XMLSchema#string"
              >urn:va:xacml:2.0:interop:rsa8:resource:hl7:progress-note</AttributeValue>
            <ResourceAttributeDesignator
                AttributeId=
                  "urn:va:xacml:2.0:interop:rsa8:resource:hl7:type"
                DataType="http://www.w3.org/2001/XMLSchema#string"/>
          </ResourceMatch>
        </Resource>
      </Resources>
    </Target>
    <PolicySetIdReference
      >urn:va:xacml:2.0:interop:rsa8:policysetid:progress-note</PolicySetIdReference>
  </PolicySet>
  <PolicySet
      PolicySetId="urn:va:xacml:2.0:interop:rsa8:policysetid:toplevel:N"
      PolicyCombiningAlgId=
        "urn:oasis:names:tc:xacml:1.0:policy-combining-algorithm:permit-overrides">
    <Target/>
    <PolicySetIdReference
      >urn:va:xacml:2.0:interop:rsa8:policysetid:N</PolicySetIdReference>
    <PolicySetIdReference
     >urn:va:xacml:2.0:interop:rsa8:policysetid:N:PermCollections</PolicySetIdReference>
  </PolicySet>
</PolicySet>